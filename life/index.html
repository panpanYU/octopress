<html style="font-size: 421.563px;"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <title>清美APP下载</title>
    <style>
        /*320px布局*/

        html {
            font-size: 100px;
        }

        body {
            font-size: 0.14rem;
            /*实际相当于14px*/
        }

        body {
            padding: 0;
            margin: 0;
        }

        .img1 {
            width: 3.2rem;
        }

        .content {
            position: relative;
            display: grid;
        }

        .content p {
            width: 1.8rem;
            text-align: center;
            bottom: 1.3rem;
            position: absolute;
            font-size: 0.18rem;
            border: 1px solid #fff;
            margin: 0 0.7rem;
            -moz-border-radius: 5px;
            /* Firefox */
            -webkit-border-radius: 5px;
            /* Safari 和 Chrome */
            border-radius: 5px;
            /* Opera 10.5+, 以及使用了IE-CSS3的IE浏览器 */
        }
        .content p a {
            padding: 0.1rem 0;
            display: block;
            color: #fff;
            text-decoration: none;
        }
    </style>
</head>
<!-- http://192.168.0.207:8088/download/xs-download.html 
	http://192.168.10.160:8088/download/xs-download.html 
	http://www.w3school.com.cn/jsref/dom_obj_navigator.asp
-->
<body>
    <div class="content">
        <img class="img1" src="bg.jpg" alt="">
        <p>
         <a href="javascript:open_or_download_app();">立即下载APP</a>
        </p>
    </div>
<script src="http://static.tramy.cn/download/js/jquery-1.11.1.min.js"></script>
<script>
    (function (doc, win) {
        // 分辨率Resolution适配
        var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
                var clientWidth = docEl.clientWidth;
                if (!clientWidth) return;
                docEl.style.fontSize = 100 * (clientWidth / 320) + 'px';
            };

        // Abort if browser does not support addEventListener
        if (!doc.addEventListener) return;
        win.addEventListener(resizeEvt, recalc, false);
        doc.addEventListener('DOMContentLoaded', recalc, false);

        // 一物理像素在不同屏幕的显示效果不一样。要根据devicePixelRatio来修改meta标签的scale,要注释上面的meta标签
        (function () {
            return;
            var dpr = scale = 1;
            var isIPhone = win.navigator.appVersion.match(/iphone/gi);
            var devicePixelRatio = win.devicePixelRatio;
            if (isIPhone) {
                // iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案
                if (devicePixelRatio >= 3 && (!dpr || dpr >= 3)) {
                    dpr = 3;
                } else if (devicePixelRatio >= 2 && (!dpr || dpr >= 2)) {
                    dpr = 2;
                } else {
                    dpr = 1;
                }
            } else {
                // 其他设备下，仍旧使用1倍的方案
                dpr = 1;
            }
            scale = 1 / dpr;

            // 
            var metaEl = "";
            metaEl = doc.createElement('meta');
            metaEl.setAttribute('name', 'viewport');
            metaEl.setAttribute('content', 'initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');
            if (docEl.firstElementChild) {
                docEl.firstElementChild.appendChild(metaEl);
            } else {
                var wrap = doc.createElement('div');
                wrap.appendChild(metaEl);
                doc.write(wrap.innerHTML);
            }
        })();

    })(document, window);  
    function open_or_download_app() {
		saveVisitLog(2);
        var apk = "store-release_V2.1.0_tramy.apk";
        var androidURL = "http://static.tramy.cn/download/app/xs/android/"+apk;
        var iosURL = "http://itunes.apple.com/app/id1427124754";
        var ua = window.navigator.userAgent.toLowerCase();
        var browser = {
            versions: function() {
                var u = navigator.userAgent,
                        app = navigator.appVersion;
                return {
                    android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1,
                    iPhone: u.indexOf('iPhone') > -1 ,
                    iPad: u.indexOf('iPad') > -1,
                    iPod: u.indexOf('iPod') > -1
                };
            } (),
            language: (navigator.browserLanguage || navigator.language).toLowerCase()
        }
        if(ua.match(/MicroMessenger/i) == 'micromessenger'){
            //如果是微信浏览器直接通过应用宝判断下载
            // window.location = "http://a.app.qq.com/o/simple.jsp?pkgname=";
            
            if(browser.versions.iPhone||browser.versions.iPad||browser.versions.iPod)
        {
            //如果是ios系统，直接跳转至appstore该应用首页，传递参数为该应用在appstroe的id号
            window.location.href="http://itunes.apple.com/app/id1427124754";
        }else if(browser.versions.android)
        {
            //如果是android系统，直接下载安装
            alert("微信安卓")
            alert(androidURL)
            window.location=androidURL;
        }

        }
        else if(browser.versions.iPhone||browser.versions.iPad||browser.versions.iPod)
        {
            //如果是ios系统，直接跳转至appstore该应用首页，传递参数为该应用在appstroe的id号
            //window.location.href="http://itunes.apple.com/app/id1300423977";
            window.location.href="http://itunes.apple.com/app/id1427124754";
        }
        else if(browser.versions.android)
        {
            alert("安卓")
            //如果是android系统，直接下载安装
            window.location=androidURL;
        }
    };  
	$( document ).ready(function() {
		var navigatorData = getNavigator();
		//alert(JSON.stringify(navigatorData));
		saveVisitLog(1);
	});
	function saveVisitLog(type){
		var log ={
			type:type,
			navigator:getNavigator()
		}
		var channel = getQueryString("channel");
		if(channel!=undefined){
			log.channel = channel
		}
		try{
			$.ajax({
                url: 'http://xsapi.tramy.cn/v1/xsCommon/app/download/log/save',
                data: JSON.stringify(log),
                contentType: "application/json",
                type:"POST",
                dataType:"text",
                xhrFields: {
                    withCredentials: false,
                },
                success: function (data) {
                   
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    
                }
            });
		}catch(err){
			console.log(err);
		}
		
	}
	function getQueryString(name)
	{
		 var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
		 var r = window.location.search.substr(1).match(reg);//search,查询？后面的参数，并匹配正则
		 if(r!=null)return  unescape(r[2]); return null;
	}
	function getNavigator(){
		var	navigatorData= {
			appCodeName: window.navigator.appCodeName, //浏览器代码名
			appName: window.navigator.appName, //浏览器的名称
			appMinorVersion: window.navigator.appMinorVersion, //浏览器补钉版本(浏览器的次级版本)
			appVersion: window.navigator.appVersion, //浏览器的平台和版本信息。
			cpuClass: window.navigator.cpuClass, //浏览器系统的 CPU 等级
			platform: window.navigator.platform, //运行浏览器的操作系统平台。
			plugins: JSON.stringify(window.navigator.plugins),
			opsProfile: window.navigator.opsProfile,
			userProfile: window.navigator.userProfile,
			systemLanguage: window.navigator.systemLanguage, //客户体系语言zh-cn简体中文(OS 使用的默认语言。)
			userLanguage: window.navigator.userLanguage, //用户语言,同上
			userAgent: window.navigator.userAgent,//由客户机发送服务器的 user-agent 头部的值。
			onLine: window.navigator.onLine, //指明系统是否处于脱机模式的布尔值。
			cookieEnabled: window.navigator.cookieEnabled, //指明浏览器中是否启用 cookie 的布尔值。
			mimeTypes: JSON.stringify(window.navigator.mimeTypes)
		}
		return navigatorData;
	}
</script>


</body></html>
